<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Writer</title>
  <meta name="description" content="Free writing on the web.">
  <meta name="keywords" content="writing,poetry,free,simple,notes">
  <meta name="author" content="Daniel Noon">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdn.quilljs.com/1.2.4/quill.snow.css">
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Libre+Baskerville|Quicksand" rel="stylesheet"> 
  <style>
    body, html {
      background-color: #263238;
      padding: 0;
      margin: 0;
    }
    body {
      height: 100%;
    }
    .ql-toolbar {
      background: white;
      position: absolute;
      z-index: 9999;
      top: 0;
      width: 100%;
      white-space: nowrap;
      overflow-x: auto;
    }
    #editor {
      color: white;
      font-size: 16px;
      /* font-family: "Inconsolata", monospace; */
      height: 100%;
      width: 100%;
      border: none;
      margin-top: 50px;
      margin-bottom: 2.5em;
    }
    #bottom {
      position: fixed;
      bottom: 0;
      width: 100%;
      right: 0;
      left: 0;
      background-color: #263238;
    }
    #password {
      width: 25%;
      min-width: 300px;
      float: right;
      height: 2em;
      border-radius: 2px;
      background: #37474f;
      border: none;
      padding-left: 5px;
      color: white;
      font-family: 'Inconsolata', monospace;
    }
    .left {
      color: white;
      font-family: 'Inconsolata', monospace;
      padding-left: 15px;
      padding-top: 8px;
    }
    .ql-container {
      font-family: "Quicksand", Roboto, sans-serif;
    }
    .ql-editor .ql-font-serif {
      font-family: "Libre Baskervile", serif !important;
    }
    .ql-editor .ql-font-monospace {
      font-family: "Inconsolata", Monaco, monospace !important;
    }
  </style>
</head>
<body>
<div id="editor">
  <h1><span class="ql-font-monospace"># Welcome!</span></h1><p><span class="ql-font-monospace" style="background-color: rgb(0, 97, 0);">This is </span><em class="ql-font-monospace" style="background-color: rgb(0, 97, 0);">Writer</em><span class="ql-font-monospace" style="background-color: rgb(0, 97, 0);">, an über-simple text editor/manager/whatever that saves everything in the cloud.</span></p><p><span class="ql-font-monospace" style="background-color: rgb(178, 107, 0);">No need to save your work as you go, nor worry about files--we take care of that for you.</span></p><p><br></p><h2><span class="ql-font-monospace">## How does it work?</span></h2><p><span class="ql-font-monospace">For now, just choose a </span><u class="ql-font-monospace">namespace</u><span class="ql-font-monospace"> down at the bottom. If it's new, we'll make a new document. Otherwise, pick up where you left off on any device; no need for an account.</span></p><p><br></p><p><span class="ql-font-monospace">Of course, we're still working on features, as new as we are. Take a look at </span><u class="ql-font-monospace">## In Development</u><span class="ql-font-monospace"> for more information.</span></p><p><br></p><h2><span class="ql-font-monospace">## Why use Writer?</span></h2><p><span class="ql-font-monospace">Well, the reason I decided to make writer is so that I could just start writing any time I wanted and not worry about storing my work. School projects could be drafted, stories could be written. All of this without a filesystem, email, or a cloud drive. Think of </span><em class="ql-font-monospace">Writer</em><span class="ql-font-monospace"> as a notes app but much more rich and completely cross-platform. It's </span><em class="ql-font-monospace">not</em><span class="ql-font-monospace"> meant for big nor media-rich projects, but it's great for informal papers, short stories, poetry, or just notes. Please know, however, that everything is public and could be viewed by anyone. Think before you post.</span></p><p><br></p><h2><span class="ql-font-monospace">## More information:</span></h2><p><span class="ql-font-monospace">I use the amazing&nbsp;open-source software </span><a class="ql-font-monospace" href="https://quilljs.com/" target="_blank">Quill</a><span class="ql-font-monospace"> for the actual text-editing functionality. I </span><em class="ql-font-monospace">highly</em><span class="ql-font-monospace"> recommend it. I also need to provide a license, which I have </span><a class="ql-font-monospace" href="https://supermegadex.github.io/writer/quill-license.txt" target="_blank">right here</a><span class="ql-font-monospace">.</span></p><p><br></p><h2><span class="ql-font-monospace">## In Development</span></h2><ul><li><span class="ql-font-monospace">Private workspaces: we are working on a feature that allows for a simple login for private spaces to write. No one will be able to see them, so you can rest easy knowing you will own the work. This is the first priority.</span></li><li><span class="ql-font-monospace">Real-time collaboration: any public workspace will show collaborators and instant changes to the document. Second priority.</span></li><li><span class="ql-font-monospace">Shared workspaces: like private, but you can share with specific users. Real-time collaboration will be implemented for better productivity.</span></li></ul>
</div>
<div id="bottom">
  <span class="left">Word Count: <span id="word-count"></span></span>
  <input id="password" type="text" placeholder="namespace" pattern="[A-z0-9À-ž\s]" />
</div>
<script src="https://cdn.quilljs.com/1.2.4/quill.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.9.0/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.9.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.9.0/firebase-database.js"></script>

<script>
var toolbarOptions = [
  ['bold', 'italic', 'underline', 'strike'],        // toggled buttons
  ['blockquote', 'code-block', 'link', 'image'],

  [{ 'header': 1 }, { 'header': 2 }],               // custom button values
  [{ 'list': 'ordered'}, { 'list': 'bullet' }],
  [{ 'script': 'sub'}, { 'script': 'super' }],      // superscript/subscript
  [{ 'indent': '-1'}, { 'indent': '+1' }],          // outdent/indent
  [{ 'direction': 'rtl' }],                         // text direction

  [{ 'size': ['small', false, 'large', 'huge'] }],  // custom dropdown

  [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme
  [{ 'font': [] }],
  [{ 'align': [] }],

  ['clean']                                         // remove formatting button
];
var quill = new Quill('#editor', {
  theme: 'snow',
  modules: {
  	toolbar: toolbarOptions
  },
  placeholder: "Start writing here!"
});
var namespace = document.querySelector("#password");
var config = {
  apiKey: "AIzaSyBGM0XNp3FGfq-KIvSdpL3XonkO5cv4pbM",
  authDomain: "writer-6aa6d.firebaseapp.com",
  databaseURL: "https://writer-6aa6d.firebaseio.com",
};
firebase.initializeApp(config);
onload = function() {
  updateLength();
  // load();
  /*
  namespace.addEventListener("keypress", function() {
  	load();
  });
  */
  namespace.addEventListener("focus", function() {
  	// clearInterval(interval);
  })
  namespace.addEventListener("blur", function() {
  	load();
  })
}
quill.on('text-change', function(delta, oldDelta, source) {
  save();
  updateLength();
});
function save() {
  // localStorage.setItem("save", JSON.stringify(quill.getContents()));
  var val = namespace.value.replace(/([\[\]?.#])+/g, "");
  firebase.database().ref(val || "delta").set(quill.getContents());
}
function load() {
  // quill.setContents(JSON.parse(localStorage.getItem("save")));
  var val = namespace.value.replace(/([\[\]?.#])+/g, "");
  firebase.database().ref(val || "delta").once('value').then(function(data) {
    quill.setContents(data.val());
    updateLength();
  });
}
function updateLength() {
  var length = quill.getText().split(/\S+/g).length;
  document.querySelector("#word-count").innerText = length;
}

</script>
